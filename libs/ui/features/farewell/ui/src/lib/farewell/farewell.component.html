<form class="flex flex-col" [formGroup]="farewellFormGroup">
  <p-floatLabel class="block mt-4">
    <input
      class="w-full border-none shadow-none text-4xl focus:outline-none"
      id="title"
      type="text"
      pInputText
      formControlName="title" />
    <label class="w-full text-4xl" for="title">Title</label>
  </p-floatLabel>

  <section class="relative">
    <strong
      uiKitSmallTextTailwindClasses
      class="absolute right-6 bottom-6 text-xs">
      {{ farewellFormGroup.get('title')?.value?.length }} /
      {{ TITLE_MAX_LENGTH }}
    </strong>
  </section>

  <feat-farewell-editor
    class="block mt-4"
    formControlName="content"
    [imageStorageProvider]="saveImages()"
    [deleteImage]="deleteImage()"
    (editorTextChange)="editorTextValue.set($event)"></feat-farewell-editor>
  <section class="relative">
    <strong
      uiKitSmallTextTailwindClasses
      class="absolute right-6 bottom-6 text-xs">
      {{ editorTextValue().length }} /
      {{ CONTENT_MAX_LENGTH }}
    </strong>
  </section>

  @let status = farewellFormGroup.get('status')?.value;

  <ng-template #statusTmpl>
    <p-button
      (onClick)="updateStatus(status)"
      [label]="
        status === farewellStatus.Published ? 'Back to draft' : 'Publish'
      "
      [rounded]="true"
      [severity]="
        status === farewellStatus.Published ? 'secondary' : 'success'
      " />
  </ng-template>

  <div class="flex justify-center gap-2">
    <ng-container *ngTemplateOutlet="statusTmpl"></ng-container>
    @if(farewellId(); as id) {
    <div
      [pTooltip]="
        status !== farewellStatus.Published ? 'Publish to see farewell' : ''
      ">
      <p-button
        (onClick)="gotoFarewell(id)"
        label="See farewell"
        [disabled]="status !== farewellStatus.Published"
        [rounded]="true"
        severity="info" />
    </div>
    }
  </div>
</form>
