<form [formGroup]="experienceForm">
    <div class="card flex flex-col justify-content-center">
        <p-stepper orientation="vertical" [(activeStep)]="stepperActive">
            <p-stepperPanel>
                <ng-template pTemplate="header" let-onClick="onClick" let-index="index">
                    <button (click)="onClick.emit()">
                        <span [ngClass]="{
                                'bg-primary border-primary': index <= stepperActive,
                                'surface-border': index > stepperActive
                            }">
                            <i class="pi pi-user" style="font-size: 1.5rem"></i>
                        </span>
                    </button>
                </ng-template>

                <ng-template pTemplate="content" let-nextCallback="nextCallback">
                    <div class="flex flex-col gap-6">
                        <p-floatLabel>
                            <input pInputText id="title" formControlName="title" class="w-full" />
                            <label for="title">Title/Role you had*</label>
                        </p-floatLabel>

                        <p-floatLabel>
                            <p-dropdown id="company" formControlName="company" class="w-full" [showClear]="true"
                                [options]="(suggestedCompanies$ | async) ?? []"
                                emptyFilterMessage="You are the first!"
                                emptyMessage="You are the first!"
                                [checkmark]="true"
                                [editable]="true" optionLabel="name" />
                            <label for="company">Company*</label>
                        </p-floatLabel>


                        <p-floatLabel>
                            <input pInputText id="title" formControlName="location" class="w-full" />
                            <label for="company">Location</label>
                            @if(geolocationAvailable) {
                                <i class="pi pi-map-marker absolute translate-y-1/2 top--1/2 right-[12px]" role="button" (click)="$event.stopPropagation(); setCurrentGeolocation()" style="font-size: 1.5rem"></i>
                            }
                        </p-floatLabel>
                    </div>

                    <div class="flex pt-4 justify-end">
                        <p-button (onClick)="nextCallback.emit()" label="Next" icon="pi pi-arrow-right"
                            iconPos="right" />
                    </div>
                </ng-template>
            </p-stepperPanel>

            <p-stepperPanel>
                <ng-template pTemplate="header" let-onClick="onClick" let-index="index">
                    <button (click)="onClick.emit()">
                        <span [ngClass]="{
                                'bg-primary border-primary': index <= stepperActive,
                                'surface-border': index > stepperActive
                            }">
                            <i class="pi pi-briefcase" style="font-size: 1.5rem"></i>
                        </span>
                    </button>
                </ng-template>
                <ng-template pTemplate="content" let-prevCallback="prevCallback" let-nextCallback="nextCallback">
                    <div class="flex flex-col gap-6">
                        <p-dropdown class="w-full" formControlName="type" [options]="experienceType"
                            placeholder="Experience type" />

                        <p-dropdown class="w-full" formControlName="locationType" [options]="locationType"
                            placeholder="Remote, hybrid or office?" />

                        <p-floatLabel>
                            <p-calendar id="startDate" [showIcon]="true" formControlName="startDate" />
                            <label for="startDate">Start date</label>
                        </p-floatLabel>

                        <div class="flex">
                            <p-inputSwitch id="currentlyWorking" inputId="currentlyWorking" [formControl]="currentlyWorkingHere" />
                            <label class="ml-2" for="currentlyWorking">Currently working here</label>
                        </div>

                        <p-floatLabel>
                            <p-calendar id="endDate" [showIcon]="true" formControlName="endDate"
                            [disabled]="currentlyWorkingHere.value" />
                            <label for="endDate">End date</label>
                        </p-floatLabel>
                    </div>

                    <div class="flex pt-4 justify-between">
                        <p-button (onClick)="prevCallback.emit()" label="Back" severity="secondary"
                            icon="pi pi-arrow-left" />
                        <p-button (onClick)="nextCallback.emit()" label="Next" icon="pi pi-arrow-right"
                            iconPos="right" />
                    </div>
                </ng-template>
            </p-stepperPanel>

            <p-stepperPanel>
                <ng-template pTemplate="header" let-onClick="onClick" let-index="index">
                    <button (click)="onClick.emit()">
                        <span [ngClass]="{
                                'bg-primary border-primary': index <= stepperActive,
                                'surface-border': index > stepperActive
                            }">
                            <i class="pi pi-bolt" style="font-size: 1.5rem"></i>
                        </span>
                    </button>
                </ng-template>
                <ng-template pTemplate="content" let-prevCallback="prevCallback">
                    <div class="flex flex-col gap-6">

                        <p-floatLabel>
                            <textarea id="description-float" formControlName="description" rows="5" cols="30" pInputTextarea>
                            </textarea>
                            <label for="description-float">Tell us about it</label>
                        </p-floatLabel>

                        <p-floatLabel>
                            <p-chips id="skills" formControlName="skills"
                            separator="," />
                            <label for="skills">Skills</label>
                        </p-floatLabel>

                        <p-floatLabel>
                            <p-chips id="links" formControlName="links" />
                            <label for="links">Links</label>
                        </p-floatLabel>

                        <p-floatLabel>
                            <p-chips id="media" formControlName="media" />
                            <label for="media">Media</label>
                        </p-floatLabel>

                        <p-fileUpload 
    name="demo[]" 
    url="https://www.primefaces.org/cdn/api/upload.php" 
    (onUpload)="onUpload($any($event))" 
    [multiple]="true" 
    accept="image/*" 
    maxFileSize="1000000">
        <ng-template pTemplate="content">
            <ul *ngIf="experienceForm.get('media')?.value?.length">
                <li *ngFor="let file of experienceForm.get('media')?.value">
                    {{ file.name }} - {{ file.size }} bytes
                </li>
            </ul>
        </ng-template>
        <ng-template pTemplate="empty">
            <div class="flex align-items-center justify-content-center flex-column">
                <p class="mt-4 mb-0">Drag and drop image files to here to upload.</p>
            </div>
        </ng-template>
</p-fileUpload>

                    </div>
                    <div class="flex pt-4 justify-start">
                        <p-button (onClick)="prevCallback.emit()" label="Back" severity="secondary"
                            icon="pi pi-arrow-left" />
                    </div>
                </ng-template>
            </p-stepperPanel>
        </p-stepper>

        <p-button class="flex justify-end mt-2" (click)="saveExperience()" label="Submit" [raised]="true" icon="pi pi-check" iconPos="right" />
    </div>
</form>